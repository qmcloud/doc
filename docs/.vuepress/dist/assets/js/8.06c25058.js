(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{341:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("div",{attrs:{align:"center"}},[s("h1",[t._v("圈木云直播")]),t._v(" "),s("h3",[t._v("自主研发的高性能直播语聊系统")]),t._v(" "),s("img",{attrs:{src:"https://img.shields.io/badge/php-7.3-blue"}}),t._v(" "),s("img",{attrs:{src:"https://img.shields.io/badge/golang-1.13-blue"}}),t._v(" "),s("img",{attrs:{src:"https://img.shields.io/badge/gin-1.4.0-lightBlue"}}),t._v(" "),s("img",{attrs:{src:"https://img.shields.io/badge/vue-2.6.10-brightgreen"}}),t._v(" "),s("img",{attrs:{src:"https://img.shields.io/badge/element--ui-2.12.0-green"}}),t._v(" "),s("img",{attrs:{src:"https://img.shields.io/badge/gorm-1.9.12-red"}})]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("版本说明")]),t._v(" "),s("ul",[s("li",[t._v("php版本: ThinkPHP + AdminLTE。")]),t._v(" "),s("li",[t._v("golang版本: k8s+微服务+vue+elementUI")])])]),t._v(" "),s("h2",{attrs:{id:"技术栈"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#技术栈"}},[t._v("#")]),t._v(" 技术栈")]),t._v(" "),s("ul",[s("li",[s("strong",[s("code",[t._v("goim")])]),t._v(" ：不多说 B站 IM架构")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("流媒体服务器")])]),t._v(" ：golang开发的高效的实时视频服务器，支持RTMP/WebRTC/HLS/HTTP-FLV/SRT/GB28181。")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("webrtc")])]),t._v(" ：Meetecho优秀的通用WebRTC服务器（SFU）；")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("MongoDB")])]),t._v(" ：云时代构建的基于文档的分布式数据库；")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("Redis")])]),t._v("：内存中的数据结构存储，用作数据库，缓存和消息代理；")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("kafka")])]),t._v(" ：队列 群聊，私聊，消息通知等。")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("Coturn")])]),t._v(" ：TURN和STUN Server的开源项目；")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("Nginx")])]),t._v(" ：高性能负载平衡器，Web服务器和有HTTPS / Quiche和Brtoli支持的反向代理；")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("K8s集群+docker")])]),t._v("：用于构建、部署和管理容器化应用程序的平台。")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("后端")])]),t._v(": php版 + ThinkPHP + AdminLTE  | golang版 + Vue + ElementUI")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("移动端")])]),t._v(": 原生开发版 | uniapp混合开发版")])]),t._v(" "),s("h2",{attrs:{id:"前端展示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端展示"}},[t._v("#")]),t._v(" 前端展示")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/20210605203510511.jpg",alt:"前端展示"}})]),t._v(" "),s("h2",{attrs:{id:"后台界面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后台界面"}},[t._v("#")]),t._v(" 后台界面")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/backend.png",alt:"vue界面"}})]),t._v(" "),s("h2",{attrs:{id:"架构图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#架构图"}},[t._v("#")]),t._v(" 架构图")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/doc.jpg",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"代码目录说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码目录说明"}},[t._v("#")]),t._v(" 代码目录说明")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("├── ergo\n│   ├── app  // app代码\n│   ├── backend // 后台接口，rpc\n│   ├── backendweb // 后台vue页面代码\n│   ├── script // 数据库脚本，简化的kubernetes部署脚本\n│   ├── .gitignore // git控制忽略文件\n│   ├── LICENSE // LICENSE文件，使用的是MIT LICENSE\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("开发模式")]),t._v(" "),s("p",[t._v("本项目使用的是微服务开发，api （http） + rpc（grpc） ， api充当聚合服务，\n复杂、涉及到其他业务调用的统一写在rpc中，如果一些不会被其他服务依赖使用的简单业务，\n可以直接写在api的logic中")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("网关")]),t._v(" "),s("p",[s("code",[t._v("nginx")]),t._v("做网关，使用nginx的auth模块，调用后端的backend服务统一鉴权，业务内部不鉴权，\n如果涉及到业务资金比较多也可以在业务中进行二次鉴权。 这块原理基本一样，可以自行替换成"),s("code",[t._v("apisix")]),t._v("、"),s("code",[t._v("kong")]),t._v("等")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("日志")]),t._v(" "),s("p",[t._v("关于日志，统一使用"),s("code",[t._v("filebeat")]),t._v("收集，上报到"),s("code",[t._v("kafka")]),t._v("中，\n"),s("code",[t._v("logstash")]),t._v("把"),s("code",[t._v("kafka")]),t._v("数据源同步到"),s("code",[t._v("elasticsearch")]),t._v("中，\n再通过kibana进行分析处理展示等。")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("监控")]),t._v(" "),s("p",[t._v("监控采用"),s("code",[t._v("prometheus")]),t._v("，只需要配置到k8s就可以了，这里可以看项目中的配置")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("链路追踪")]),t._v(" "),s("p",[t._v("默认"),s("code",[t._v("jaeger")]),t._v("、"),s("code",[t._v("zipkin")]),t._v("支持，只需要配置到k8s就可以了，这里可以看项目中的配置")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("消息队列")]),t._v(" "),s("p",[t._v("这里使用可kq，kq是基于kafka做的高性能消息队列")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("延迟队列、定时任务")]),t._v(" "),s("p",[t._v("延迟队列、定时任务本项目使用的是"),s("code",[t._v("asynq")]),t._v(" ， google团队给予redis开发的简单中间件， asynq也支持消息队列，你也可也把kq消息队列替换成kafka")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/hibiken/asynq",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/hibiken/asynq"),s("OutboundLink")],1)])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("分布式事务")]),t._v(" "),s("p",[t._v("分布式事务使用的是"),s("code",[t._v("dtm")]),t._v("，单节点每秒1W条事务，平常抢购秒杀足够应付了。")])]),t._v(" "),s("h2",{attrs:{id:"启动服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动服务"}},[t._v("#")]),t._v(" 启动服务")]),t._v(" "),s("div",{staticClass:"language-golang line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ go run admin.go -f etc/admin.yaml\nStarting server at 0.0.0.0:8888...\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h2",{attrs:{id:"curl调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#curl调用"}},[t._v("#")]),t._v(" CURL调用")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" GET http://localhost:8888/api/order/get/1\nHTTP/1.1 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" OK\nContent-Type: application/json\nDate: Sun, 07 Feb "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v(" 03:45:05 GMT\nContent-Length: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("h2",{attrs:{id:"演示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#演示"}},[t._v("#")]),t._v(" 演示")]),t._v(" "),s("p",[t._v("⨳ Web演示地址："),s("a",{attrs:{href:"http://voice.onionnews.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://voice.onionnews.cn/"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("⨳ Web后台管理："),s("a",{attrs:{href:"http://voice.onionnews.cn/admin",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://voice.onionnews.cn/admin"),s("OutboundLink")],1),t._v(" 账号：admin 密码：BCFind5")]),t._v(" "),s("p",[t._v("⨳ 直播APP下载地址： "),s("a",{attrs:{href:"https://app.onionnews.cn/live",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://app.onionnews.cn/live"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("⨳ Uniapp演示地址："),s("a",{attrs:{href:"http://h5.onionnews.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://h5.onionnews.cn/"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("⨳ Vue3版本演示地址："),s("a",{attrs:{href:"http://web.onionnews.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://web.onionnews.cn/"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("⨳ 直播后台管理："),s("a",{attrs:{href:"http://admin.onionnews.cn/xjmuyHKnec.php/index/login",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://admin.onionnews.cn/xjmuyHKnec.php/index/login"),s("OutboundLink")],1),t._v(" 账号：admin 密码：admin123")]),t._v(" "),s("p",[t._v("⨳ 语聊APP下载："),s("a",{attrs:{href:"https://app.onionnews.cn/voice",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://app.onionnews.cn/voice"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("⨳ 语聊后台管理："),s("a",{attrs:{href:"http://live.onionnews.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://live.onionnews.cn"),s("OutboundLink")],1),t._v(" 账号：admin 密码：123456")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("IOS需要提供UUID：手机通过safari浏览器打开h5页面获取UDID -"),s("a",{attrs:{href:"https://www.yunedit.com/udid",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.yunedit.com/udid"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"联系方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#联系方式"}},[t._v("#")]),t._v(" 联系方式")]),t._v(" "),s("p",[s("strong",[t._v("QQ")]),t._v("：407193275 【请备注好信息，否则不加】\n"),s("strong",[t._v("微信")]),t._v("：BCFind5 【请备注好信息，否则不加】")]),t._v(" "),s("h2",{attrs:{id:"参与贡献"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参与贡献"}},[t._v("#")]),t._v(" 参与贡献")]),t._v(" "),s("ref",{attrs:{link:"/community/contribution/",title:"贡献指南"}})],1)}),[],!1,null,null,null);s.default=n.exports}}]);