(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{342:function(s,a,e){"use strict";e.r(a);var n=e(0),t=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("微服务部署")]),s._v(" "),a("p",[s._v("本节通过jenkins来进行简单的服务部署到k8s演示。")])]),s._v(" "),a("h2",{attrs:{id:"准备工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[s._v("#")]),s._v(" 准备工作")]),s._v(" "),a("ul",[a("li",[s._v("k8s集群安装")]),s._v(" "),a("li",[s._v("gitlab环境安装")]),s._v(" "),a("li",[s._v("jenkins环境安装")]),s._v(" "),a("li",[s._v("redis&mysql&nginx&etcd安装")]),s._v(" "),a("li",[s._v("goctl安装")]),s._v(" "),a("li",[s._v("golang >= 1.18 需要支持泛型")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("goctl确保k8s每个node节点上都有")]),s._v(" "),a("p",[s._v("以上环境安装请自行google，这里不做篇幅介绍。")])]),s._v(" "),a("h2",{attrs:{id:"服务部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务部署"}},[s._v("#")]),s._v(" 服务部署")]),s._v(" "),a("h3",{attrs:{id:"_1、gitlab代码仓库相关准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、gitlab代码仓库相关准备"}},[s._v("#")]),s._v(" 1、gitlab代码仓库相关准备")]),s._v(" "),a("h4",{attrs:{id:"_1-1、添加ssh-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、添加ssh-key"}},[s._v("#")]),s._v(" 1.1、添加SSH Key")]),s._v(" "),a("p",[s._v("进入gitlab，点击用户中心，找到"),a("code",[s._v("Settings")]),s._v("，在左侧找到"),a("code",[s._v("SSH Keys")]),s._v("tab\n"),a("img",{attrs:{src:"/img/doc/ssh-add-key.png",alt:"ssh key"}})]),s._v(" "),a("ul",[a("li",[s._v("1、在jenkins所在机器上查看公钥")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ~/.ssh/id_rsa.pub\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("2、如果没有，则需要生成，如果存在，请跳转到第3步")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ ssh-keygen "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" rsa "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"email@example.com"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v('"email@example.com" 可以替换为自己的邮箱')])]),s._v(" "),a("p",[s._v("完成生成后，重复第一步操作")]),s._v(" "),a("ul",[a("li",[s._v("3、将公钥添加到gitlab中")])]),s._v(" "),a("h4",{attrs:{id:"_1-2、上传代码到gitlab仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、上传代码到gitlab仓库"}},[s._v("#")]),s._v(" 1.2、上传代码到gitlab仓库")]),s._v(" "),a("p",[s._v("新建工程"),a("code",[s._v("ergo")]),s._v("并上传代码，这里不做细节描述。")]),s._v(" "),a("h3",{attrs:{id:"_2、jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、jenkins"}},[s._v("#")]),s._v(" 2、jenkins")]),s._v(" "),a("h4",{attrs:{id:"_2-1、添加凭据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、添加凭据"}},[s._v("#")]),s._v(" 2.1、添加凭据")]),s._v(" "),a("ul",[a("li",[s._v("查看jenkins所在机器的私钥，与前面gitlab公钥对应")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" id_rsa\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("进入jenkins，依次点击"),a("code",[s._v("Manage Jenkins")]),s._v("-> "),a("code",[s._v("Manage Credentials")]),s._v(" "),a("img",{attrs:{src:"/img/doc/jenkins-credentials.png",alt:"credentials"}})])]),s._v(" "),a("li",[a("p",[s._v("进入"),a("code",[s._v("全局凭据")]),s._v("页面，添加凭据，"),a("code",[s._v("Username")]),s._v("是一个标识，后面添加pipeline你知道这个标识是代表gitlab的凭据就行，Private Key`即上面获取的私钥\n"),a("img",{attrs:{src:"/img/doc/jenkins-add-credentials.png",alt:"jenkins-add-credentials"}})])])]),s._v(" "),a("h4",{attrs:{id:"_2-2、-添加全局变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、-添加全局变量"}},[s._v("#")]),s._v(" 2.2、 添加全局变量")]),s._v(" "),a("p",[s._v("进入"),a("code",[s._v("Manage Jenkins")]),s._v("->"),a("code",[s._v("Configure System")]),s._v("，滑动到"),a("code",[s._v("全局属性")]),s._v("条目，添加docker私有仓库相关信息，如图为"),a("code",[s._v("docker用户名")]),s._v("、"),a("code",[s._v("docker用户密码")]),s._v("、"),a("code",[s._v("docker私有仓库地址")]),s._v(" "),a("img",{attrs:{src:"/img/doc//docker_env.png",alt:"docker_server"}})]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[a("code",[s._v("docker_user")]),s._v(" 修改为你的docker用户名")]),s._v(" "),a("p",[a("code",[s._v("docker_pass")]),s._v(" 修改为你的docker用户密码")]),s._v(" "),a("p",[a("code",[s._v("docker_server")]),s._v(" 修改为你的docker服务器地址")]),s._v(" "),a("p",[s._v("这里我使用的私有仓库，如果没有云厂商提供的私有仓库使用，可以自行搭建一个私有仓库，这里就不赘述了，大家自行google。")])]),s._v(" "),a("h4",{attrs:{id:"_2-3、配置git"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、配置git"}},[s._v("#")]),s._v(" 2.3、配置git")]),s._v(" "),a("p",[s._v("进入"),a("code",[s._v("Manage Jenkins")]),s._v("->"),a("code",[s._v("Global Tool Configureation")]),s._v("，找到Git条目，填写jenkins所在机器git可执行文件所在path，如果没有的话，需要在jenkins插件管理中下载Git插件。\n"),a("img",{attrs:{src:"/img/doc/jenkins-git.png",alt:"jenkins-git"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/doc/jenkins-configure.png",alt:"jenkins-configure"}})]),s._v(" "),a("h4",{attrs:{id:"_2-4、-添加一个pipeline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4、-添加一个pipeline"}},[s._v("#")]),s._v(" 2.4、 添加一个Pipeline")]),s._v(" "),a("blockquote",[a("p",[s._v("pipeline用于构建项目，从gitlab拉取代码->生成Dockerfile->部署到k8s均在这个步骤去做，这里是演示环境，为了保证部署流程顺利，\n需要将jenkins安装在和k8s集群的其中过一个节点所在机器上，我这里安装在master上的。")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("获取凭据id 进入凭据页面，找到Username为"),a("code",[s._v("gitlab")]),s._v("的凭据id\n"),a("img",{attrs:{src:"/img/doc/jenkins-credentials-id.png",alt:"jenkins-credentials-id"}})])]),s._v(" "),a("li",[a("p",[s._v("进入jenkins首页，点击"),a("code",[s._v("新建Item")]),s._v("，名称为"),a("code",[s._v("user")]),s._v(" "),a("img",{attrs:{src:"/img/doc/jenkins-new-item.png",alt:"jenkins-add-item"}})])]),s._v(" "),a("li",[a("p",[s._v("查看项目git地址\n"),a("img",{attrs:{src:"/img/doc/gitlab-git-url.png",alt:"gitlab-git-url"}})])]),s._v(" "),a("li",[a("p",[s._v("添加服务类型Choice Parameter,在General中勾选"),a("code",[s._v("This project is parameterized")]),s._v(",点击"),a("code",[s._v("添加参数")]),s._v("选择"),a("code",[s._v("Choice Parameter")]),s._v("，按照图中添加选择的值常量(api、rpc)及接收值的变量(type)，后续在Pipeline script中会用到。\n"),a("img",{attrs:{src:"/img/doc/jenkins-choice.png",alt:"jenkins-choice-parameter"}})])]),s._v(" "),a("li",[a("p",[s._v("配置"),a("code",[s._v("user")]),s._v("，在"),a("code",[s._v("user")]),s._v("配置页面，向下滑动找到"),a("code",[s._v("Pipeline script")]),s._v(",填写脚本内容")])])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pipeline {\n  agent any\n  parameters {\n      gitParameter name: 'branch', \n      type: 'PT_BRANCH',\n      branchFilter: 'origin/(.*)',\n      defaultValue: 'master',\n      selectedValue: 'DEFAULT',\n      sortMode: 'ASCENDING_SMART',\n      description: '选择需要构建的分支'\n  }\n\n  stages {\n      stage('服务信息')    {\n          steps {\n              sh 'echo 分支：$branch'\n              sh 'echo 构建服务类型：${JOB_NAME}-$type'\n          }\n      }\n\n\n      stage('check out') {\n          steps {\n              checkout([$class: 'GitSCM', \n              branches: [[name: '$branch']],\n              doGenerateSubmoduleConfigurations: false, \n              extensions: [], \n              submoduleCfg: [],\n              userRemoteConfigs: [[credentialsId: '${credentialsId}', url: '${gitUrl}']]])\n          }   \n      }\n\n      stage('获取commit_id') {\n          steps {\n              echo '获取commit_id'\n              git credentialsId: '${credentialsId}', url: '${gitUrl}'\n              script {\n                  env.commit_id = sh(returnStdout: true, script: 'git rev-parse --short HEAD').trim()\n              }\n          }\n      }\n\n\n      stage('goctl版本检测') {\n          steps{\n              sh '/usr/local/bin/goctl -v'\n          }\n      }\n\n      stage('Dockerfile Build') {\n          steps{\n                 sh '/usr/local/bin/goctl docker -go service/${JOB_NAME}/${type}/${JOB_NAME}.go'\n                 script{\n                     env.image = sh(returnStdout: true, script: 'echo ${JOB_NAME}-${type}:${commit_id}').trim()\n                 }\n                 sh 'echo 镜像名称：${image}'\n                 sh 'docker build -t ${image} .'\n          }\n      }\n\n      stage('上传到镜像仓库') {\n          steps{\n              sh '/root/dockerlogin.sh'\n              sh 'docker tag  ${image} ${dockerServer}/${image}'\n              sh 'docker push ${dockerServer}/${image}'\n          }\n      }\n\n      stage('部署到k8s') {\n          steps{\n              script{\n                  env.deployYaml = sh(returnStdout: true, script: 'echo ${JOB_NAME}-${type}-deploy.yaml').trim()\n                  env.port=sh(returnStdout: true, script: '/root/port.sh ${JOB_NAME}-${type}').trim()\n              }\n\n              sh 'echo ${port}'\n\n              sh 'rm -f ${deployYaml}'\n              sh '/usr/local/bin/goctl kube deploy -secret dockersecret -replicas 2 -nodePort 3${port} -requestCpu 200 -requestMem 50 -limitCpu 300 -limitMem 100 -name ${JOB_NAME}-${type} -namespace hey-go-zero -image ${dockerServer}/${image} -o ${deployYaml} -port ${port}'\n              sh '/usr/bin/kubectl apply -f ${deployYaml}'\n          }\n      }\n      \n      stage('Clean') {\n          steps{\n              sh 'docker rmi -f ${image}'\n              sh 'docker rmi -f ${dockerServer}/${image}'\n              cleanWs notFailBuild: true\n          }\n      }\n  }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("${credentialsId} 要替换为你的具体凭据值, 即 [添加凭据] 模块中的一串字符串, ${gitUrl} 需要替换为你代码的git仓库地址，其他的 ${..} 形式的变量无需修改, 保持原样即可.")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/doc/user-pipeline-script.png",alt:"user-pipepine-script"}})]),s._v(" "),a("h3",{attrs:{id:"port-sh参考内容如下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#port-sh参考内容如下"}},[s._v("#")]),s._v(" port.sh参考内容如下")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user-api"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user-rpc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"course-api"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1002")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"course-rpc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1003")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"selection-api"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1004")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("esac")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("其中dockerlogin.sh内容")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" login "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--username")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$docker")]),s._v("-user "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$docker")]),s._v("-pass "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$docker")]),s._v("-server\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ul",[a("li",[s._v("$docker-user: docker登录用户名")]),s._v(" "),a("li",[s._v("$docker-pass: docker登录用户密码")]),s._v(" "),a("li",[s._v("$docker-server: docker私有地址")])]),s._v(" "),a("h2",{attrs:{id:"查看pipeline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看pipeline"}},[s._v("#")]),s._v(" 查看pipeline")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/doc/jenkins-build-with-parameters.png",alt:"build with parameters"}}),s._v(" "),a("img",{attrs:{src:"/img/doc/pipeline.png",alt:"build with parameters"}})]),s._v(" "),a("h2",{attrs:{id:"查看k8s服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看k8s服务"}},[s._v("#")]),s._v(" 查看k8s服务")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/doc/k8s-01.png",alt:"k8s01"}}),s._v("~~")])])}),[],!1,null,null,null);a.default=t.exports}}]);